<!--<link rel="import" href="../polymer/lib/elements/dom-if.html">-->
<!--<link rel="import" href="../polymer/lib/elements/dom-repeat.html">-->

<dom-module id="audio-reverb">
<template>
<style>
:host {
display: block;
}

:host .field {
display: inline;
}
</style>

<div class="audio-reverb" role="region" aria-label$="{{label}}">
<div class="row">
<span class="label">[[label]]</span>

<ui-boolean name="bypass" label="bypass" value="{{bypass}}"></ui-boolean>

</div><div class="row">

<ui-number name="level" label="level" value="{{level}}" min="0.0" max="1.0" step="0.0001"></ui-number>

<ui-file name="buffer" label="impulse" type="readAsText" value="{{value}}"></ui-file>
</label>
</div><!-- .row -->

</div>

</template>

<script>
"use strict";

(function () {
var instanceCount  = 0;

class AudioReverb extends _AudioContext_ {
static get is() { return "audio-reverb"; }

static get properties () {
return {
label: {
type: String,
value: ""
}, // label

bypass: {
type: Boolean,
value: false,
notify: true,
observer: "_bypass"
}, // bypass

invertPhase: {
type: Boolean,
value: false,
notify: true,
observer: "_invertPhase"
}, // invertPhase

delayTime: {
type: Number,
value: 0.0,
notify: true,
observer: "delayTimeChanged"
} // delayTime
}; // return
} // get properties

constructor () {
super ();
instanceCount += 1;
this._id = AudioReverb.is + instanceCount;
if (this.__debug()) this.label = this._id;

this._init (audio.createDelay());
this._audioIn.channelCount = this._in.channelCount = this._audioOut.channelCount = this._out.channelCount = this._audioNode.channelCount = 1;
this._audioIn.channelCountMode = this._in.channelCountMode = this._audioOut.channelCountMode = this._out.channelCountMode = this._audioNode.channelCountMode = "explicit";
} // constructor

connectedCallback () {
super.connectedCallback ();
if (this.contextCheck(AudioReverb.is)) {
this.whenAllChildrenLoaded (this.addFieldLabels);
} // if
} // connectedCallback

delayTimeChanged (value) {
this._audioNode.delayTime.value = value;
} // delayTimeChanged

} // class AudioReverb

window.customElements.define(AudioReverb.is, AudioReverb);


/*function getData(url) {
source = audioCtx.createBufferSource();
var request = new XMLHttpRequest();
request.open("GET", url, true);
request.responseType = 'arraybuffer';

request.onload = function() {
var audioData = request.response;

audioCtx.decodeAudioData(audioData).then (function(buffer) {
source.buffer = buffer;

},

function(e){ console.log("Error with decoding audio data" + e.err); });

}

request.send();
}

// wire up buttons to stop and play audio

play.onclick = function() {
getData();
source.start(0);
play.setAttribute('disabled', 'disabled');
}

stop.onclick = function() {
source.stop(0);
play.removeAttribute('disabled');
}
*/


})();
</script>
</dom-module>
