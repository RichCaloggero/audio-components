<link rel="import" href="/styles.html">
<!--<link rel="import" href="../polymer/lib/elements/dom-if.html">-->
<!--<link rel="import" href="../polymer/lib/elements/dom-repeat.html">-->

<dom-module id="audio-series">
<template>
<style include="audio-component-styles">
</style>

<div class="audio-series" role="region" aria-label$="{{label}}">
<span class="label">{{label}}</span>

<div class="field" data-name="bypass">
<label>Bypass</label>
<br><input type="checkbox" checked="{{bypass::change}}">
</div>

<slot on-slotchange="handleSlotChange"></slot>
</div>

</template>

<script>
// audio-series
"use strict";

(function () {
var instanceCount = 0;

class AudioSeries extends _AudioContext_ {
static get is() { return "audio-series"; }

static get properties () {
return {
label: {
type: String,
value: ""
}, // label

bypass: {
type: Boolean,
value: false,
notify: true,
observer: "_bypass"
} // bypass
}; // return
} // get properties

constructor () {
super ();
instanceCount += 1;
this._id = AudioSeries.is + instanceCount;

this._init ();
} // constructor

connectedCallback () {
super.connectedCallback ();
//this.whenAllChildrenLoaded (this.connectAll);
this.addFieldLabels ();
} // connectedCallback

connectAll (nodes) {
if (nodes.length < 1) return;
if (nodes[0].localName === "dom-repeat") return;
let lastChild = nodes[nodes.length-1];

if (nodes[0]._in) {
this._audioIn.connect (nodes[0]._in);
} // if

for (var i=0; i<nodes.length-1; i++) {
let e1 = nodes[i], e2 = nodes[i+1];

alert (`trying ${e1.localName} ${e2.localName}`);
debugger;
e1._out.connect (e2._in);
} // for

if (lastChild._out) {
this.lastElementChild._out.connect (this._audioOut);
} // if

//console.log(`connectAll complete - ${this.label}`);
} // connectAll


} // class AudioSeries

window.customElements.define(AudioSeries.is, AudioSeries);
})(); // module
</script>
</dom-module>
