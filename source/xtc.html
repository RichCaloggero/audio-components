<!doctype html>
<head>
<meta charset="utf-8">
<title>Fun with Filters</title>
<!--<script src="./resonance-audio.min.js" crossorigin="anonymous"></script>-->
<script src="loader.js"></script>
</head>
<body>
<audio-context hide="bypass" label="filt" shortcuts="enableAutomation alt shift r">
<audio-series>
<audio-player label="player" shortcuts="src alt shift u" src="media/uno momento.mp3"></audio-player>

<audio-series label="master"  mix=".4" shortcuts="bypass shift alt m">
<audio-filter type="highpass" frequency="160" q="0.001"></audio-filter>
<audio-gain gain="-1"></audio-gain>

<audio-parallel>
<audio-series>
<audio-delay delay="0.00001"></audio-delay>
<audio-split  swap-inputs>
<audio-gain gain=".8"></audio-gain>
<audio-gain gain=".8"></audio-gain>
</audio-split>
</audio-series>

<audio-series>
<audio-delay delay="0.00002"></audio-delay>
<audio-split  swap-inputs>
<audio-gain gain=".6"></audio-gain>
<audio-gain gain=".6"></audio-gain>
</audio-split>
</audio-series>

<audio-series>
<audio-delay delay="0.00003"></audio-delay>
<audio-split  swap-inputs>
<audio-gain gain=".4"></audio-gain>
<audio-gain gain=".4"></audio-gain>
</audio-split>
</audio-series>

<audio-series>
<audio-delay delay="0.00004"></audio-delay>
<audio-split  swap-inputs>
<audio-gain gain=".2"></audio-gain>
<audio-gain gain=".2"></audio-gain>
</audio-split>
</audio-series>

<audio-series>
<audio-delay delay="0.00005"></audio-delay>
<audio-split  swap-inputs>
<audio-gain gain=".1"></audio-gain>
<audio-gain gain=".1"></audio-gain>
</audio-split>
</audio-series>
</audio-parallel>

<audio-gain label="master volume" shortcuts="gain alt shift v" max="5"></audio-gain>
</audio-series>

<audio-destination></audio-destination>
</audio-series>
</audio-context>

<div id="set" aria-label="set all" role="region">
<label>Bypass: <input type="checkbox" id="bypass"></label>
<label for="q">q:</label> <input type="number" id="q" min="0.0001" max="100" step=".0001">
<label>type: <input type="text" id="type"></label>
<br><label>function: <input type="text" id="function"></label>
</div>

<script>
const q = document.querySelector("#set #q");
const type = document.querySelector("#set #type");

document.querySelector("#set").addEventListener("change", setAll);

function setAll (e) {
const attr = e.target.id;
const value = e.target.value;
const filters = document.querySelectorAll("audio-parallel audio-filter");

filters.forEach(f => {
if (attr === "function") f = f.nextElementSibling;

if (attr === "bypass") {
if (e.target.checked) f.setAttribute("bypass", true);
else f.removeAttribute("bypass");
} else {
f.setAttribute(attr, value)
} // if
});
} // setAll

</script>

</body>
</html>
