<!doctype html>
<head>
<meta charset="utf-8">
<title>Fixed Delay</title>
<script src="loader.js"></script>
</head>
<body>
<fieldset id="parameters">
<legend><h2>Parameters</h2></legend>
<label>Gain: <input type="range" id="gain" min="-0.98" value="0.8" max="0.98" step="0.02"></label>
<label>delay: <input type="range" id="delay" min="0" value="1" max="128"></label>
</fieldset>


<audio-context automation-interval="0.1" hide="bypass" label="test" shortcuts="enableAutomation alt shift r">
<audio-series>
<audio-player label="player" shortcuts="src alt shift u" src="media/D2_02_Thats What Love Will Make You Do.flac"></audio-player>

<audio-series id="master" label="master">
<audio-filter label="filter" type="lowpass" frequency="1000" hide="mix, gain, detune"></audio-filter>

<audio-series id="feed-forward" label="feed forward" hide="mix" feed-forward>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="-0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
<audio-series><audio-channelSwap></audio-channelSwap><audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay><audio-gain gain="0.8"></audio-gain></audio-series>
</audio-series><!-- feed forward -->


<!--<audio-series label="feedback" hide="mix" feed-back>
<audio-channelSwap></audio-channelSwap>
<audio-fixed-delay label="fixed delay" delay="1" hide="mix, bypass"></audio-fixed-delay>
</audio-series>
-->
</audio-series>

<audio-destination label="speakers"></audio-destination>
</audio-series>
</audio-context>

<script>
const feedForward = document.querySelector("#feed-forward");

document.querySelector("#gain").addEventListener("change", e => {
gains().forEach((g,i) => {
const gain = 
(i%2===0? -1 : 1) * 
Number(e.target.value);
g.setAttribute("gain", gain);
});
});

function gains () {return feedForward.querySelectorAll("audio-gain");}
</script>

</body>
</html>
