<!doctype html>
<head>
<meta charset="utf-8">
<title>feedback</title>
<!--<script src="./resonance-audio.min.js" crossorigin="anonymous"></script>-->
<script src="loader.js"></script>
</head>
<body>
<fieldset id="parameters">
<legend><h2>Parameters</h2></legend>
<div id="statusMessage" role="status"></div>
<label for="crossover">crossover: </label>
<input id="crossover" type="number" min="500" value="1000" max="2500" step="10" accesskey="c">

<br><label for="q">q: </label>
<input id="q" type="range" min="0" value="1" max="10" step=".1" accesskey="q">

</fieldset>


<audio-context sample-rate="88200" automation-interval="100" hide="bypass" label="test" shortcuts="enableAutomation alt shift r">
<audio-series>
<audio-player label="player" shortcuts="src alt shift u" src="media/D2_02_Thats What Love Will Make You Do.flac"></audio-player>

<audio-control>
<audio-panner bypass label="panner" maxDistance="1000" refDistance="15" rolloffFactor="5"></audio-panner>

<audio-parameter label="control x" name="x" function="c(t/3, -10, 10)"></audio-parameter>
<audio-parameter label="control z" name="z" function="s(t, -10, 10)"></audio-parameter>

<!--<audio-parameter name="positionX"><audio-series>
<audio-oscillator label="control x" frequency="0.3" max="20" step=".1" hide="detune, bypass, mix"></audio-oscillator>
<audio-gain label="range of x" gain="0.5" step=".01" hide="bypass, mix"></audio-gain>
</audio-series></audio-parameter>

<audio-parameter name="positionZ"><audio-series>
<audio-oscillator label="control z" frequency="0.3" max="20" step="0.1" hide="detune, bypass, mix"></audio-oscillator>
<audio-delay label="phase of z" delay="0.5" hide="bypass, mix"></audio-delay>
<audio-gain label="range of z" gain="0.5" step="0.01" hide="bypass, mix"></audio-gain>
</audio-series></audio-parameter>
-->
</audio-control>

<audio-series id="master" label="master" mix="-1">

<audio-series id="container" >
<audio-parallel>
<audio-series id="lowband" silent-bypass label="low band" hide="mix">
<audio-filter type="lowpass" frequency="1000" q="4"></audio-filter>
<audio-channelSwap></audio-channelSwap>
<audio-control>
<audio-stereo-processor label="rotate low"></audio-stereo-processor>
<audio-parameter label="control rotate low" name="rotation" function="s(t, -90,90)"></audio-parameter>
</audio-control>

</audio-series><audio-series id="highband" silent-bypass label="high band" hide="mix">
<audio-filter type="highpass" frequency="1000" q="4"></audio-filter>
<audio-control>
<audio-stereo-processor label="rotate high"></audio-stereo-processor>
<audio-parameter label="control rotate high" name="rotation" function="s(t, -90,90)"></audio-parameter>
</audio-control>
</audio-series>
</audio-parallel>

</audio-series><!-- container -->

<audio-gain label="volume" gain="1.5" hide="mix, bypass"></audio-gain>
<audio-filter label="bass" type="lowshelf" frequency="200" gain="4" hide="detune, mix, type"></audio-filter>
<audio-compressor bypass label="compressor" ratio="2" threshold="-30" knee="20" attack="0.2" release="5.0" hide="mix"></audio-compressor>
</audio-series><!-- master -->

<audio-destination label="speakers"></audio-destination>
</audio-series>
</audio-context>

<script>
const container = document.querySelector("#container");
const master = document.querySelector("#master");

document.querySelector("#crossover").addEventListener("change", e => {
filters().forEach(f => f.setAttribute("frequency", Number(e.target.value)))
}); // change

document.querySelector("#q").addEventListener("change", e => {
filters().forEach(f => f.setAttribute("q", Number(e.target.value)))
}); // change

function filters () {return container.querySelectorAll("#lowband audio-filter, #highband audio-filter");}

</script>

</body>
</html>
