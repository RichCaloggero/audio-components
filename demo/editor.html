<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

<title>Audio Components editor</title>

<script src="../bower_components/webcomponentsjs/webcomponents-loader.js"></script>

<link rel="import" href="../audio-context.html">
<link rel="import" href="../audio-series.html">
<link rel="import" href="../audio-parallel.html">
<link rel="import" href="../audio-split.html">
<link rel="import" href="../audio-merge.html">

<link rel="import" href="../audio-player.html">
<link rel="import" href="../audio-destination.html">
<link rel="import" href="../audio-gain.html">
<link rel="import" href="../audio-filter.html">
<link rel="import" href="../audio-delay.html">
<link rel="import" href="../audio-pan.html">
<link rel="import" href="../audio-convolver.html">
<link rel="import" href="../audio-reverb.html">
<link rel="import" href="../audio-xtc.html">

<link rel="import" href="../ui-number.html">
<link rel="import" href="../ui-boolean.html">

<link rel="import" href="../audio-control.html">
</head>
<body>
<h1>audio component demo</h1>

<div id="editor">
<label>Edit: <input type="checkbox" id="edit"></label>
<span id="file" style="display:none">
<label>File: <input type="text" id="fileName" value="demo.txt"></label>
<button id="getFile">go</button>
</span>

<br><textarea id="source" rows="20" cols="132" wrap="off" style="display:none"></textarea>
</div><!-- editor -->

<div id="demo">
</div>

<script>
let editor = document.querySelector ("#editor");
let demo = document.querySelector ("#demo");
let edit = document.querySelector("#editor #edit");
let file = document.querySelector("#editor #file");
let fileName = document.querySelector("#editor #fileName");
let getFile = document.querySelector("#editor #getFile");
let source = document.querySelector ("#editor #source");
let html = "";

getFile.addEventListener ("click", (e) => {
loadFile (fileName.value, (text) => {
source.value = text;
}); // getFile
}); // listen

edit.addEventListener ("click", (e) => {
if (e.target.checked) {
enableEditing ();
} else {
disableEditing ();
} // if
}); // listen

function enableEditing () {
file.style.display = "block";
source.style.display = "block";
} // enableEditing

function disableEditing () {
file.style.display = "none";
source.style.display = "none";
save ();
} // disableEditing


function save () {
html = source.value;
demo.innerHTML = "";
demo.innerHTML = html;
} // save

function loadFile (url, callback) {
var request = new XMLHttpRequest();
request.responseType = "text/plain";
request.open("GET", url, true);
console.log (`requesting ${url}...`);

request.addEventListener("load", function () {
console.log ("- loaded...");
if (request.response) {
callback (request.response);
} // if
}); // load

request.send();
} // loadFile

</script>

</body>
</html>
